{
  "path": ".",
  "variables": {
    "auto_scaling": {
      "name": "auto_scaling",
      "type": "object({\n    cpu = object({\n      rate_increase_percent       = optional(number, 10)\n      rate_limit_count_per_member = optional(number, 20)\n      rate_period_seconds         = optional(number, 900)\n      rate_units                  = optional(string, \"count\")\n    })\n    disk = object({\n      capacity_enabled             = optional(bool, false)\n      free_space_less_than_percent = optional(number, 10)\n      io_above_percent             = optional(number, 90)\n      io_enabled                   = optional(bool, false)\n      io_over_period               = optional(string, \"15m\")\n      rate_increase_percent        = optional(number, 10)\n      rate_limit_mb_per_member     = optional(number, 3670016)\n      rate_period_seconds          = optional(number, 900)\n      rate_units                   = optional(string, \"mb\")\n    })\n    memory = object({\n      io_above_percent         = optional(number, 90)\n      io_enabled               = optional(bool, false)\n      io_over_period           = optional(string, \"15m\")\n      rate_increase_percent    = optional(number, 10)\n      rate_limit_mb_per_member = optional(number, 114688)\n      rate_period_seconds      = optional(number, 900)\n      rate_units               = optional(string, \"mb\")\n    })\n  })",
      "description": "Optional rules to allow the database to increase resources in response to usage. Only a single autoscaling block is allowed. Make sure you understand the effects of autoscaling, especially for production environments. See https://ibm.biz/autoscaling-considerations in the IBM Cloud Docs.",
      "pos": {
        "filename": "variables.tf",
        "line": 126
      }
    },
    "backup_crn": {
      "name": "backup_crn",
      "type": "string",
      "description": "The CRN of a backup resource to restore from. The backup is created by a database deployment with the same service ID. The backup is loaded after provisioning and the new deployment starts up that uses that data. A backup CRN is in the format crn:v1:\u003c…\u003e:backup:. If omitted, the database is provisioned empty.",
      "source": [
        "ibm_database.postgresql_db.backup_id"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 229
      }
    },
    "backup_encryption_key_crn": {
      "name": "backup_encryption_key_crn",
      "type": "string",
      "description": "The CRN of a Key Protect key, that you want to use for encrypting disk that holds deployment backups. Only used if var.kms_encryption_enabled is set to true. If no value passed, the value passed for the 'kms_key_crn' variable will be used. BYOK for backups is available only in US regions us-south and us-east, and eu-de. Only keys in the us-south and eu-de are durable to region failures. To ensure that your backups are available even if a region failure occurs, you must use a key from us-south or eu-de. Take note that Hyper Protect Crypto Services for IBM Cloud® Databases backups is not currently supported, so if no value is passed here, but a HPCS value is passed for var.kms_key_crn, databases backup encryption will use the default encryption keys.",
      "pos": {
        "filename": "variables.tf",
        "line": 183
      }
    },
    "cbr_rules": {
      "name": "cbr_rules",
      "type": "list(object({\n    description = string\n    account_id  = string\n    rule_contexts = list(object({\n      attributes = optional(list(object({\n        name  = string\n        value = string\n    }))) }))\n    enforcement_mode = string\n  }))",
      "description": "(Optional, list) List of CBR rules to create",
      "default": [],
      "source": [
        "module.cbr_rule",
        "module.cbr_rule",
        "module.cbr_rule",
        "module.cbr_rule",
        "module.cbr_rule"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 209
      }
    },
    "configuration": {
      "name": "configuration",
      "type": "object({\n    max_connections            = optional(number)\n    max_prepared_transactions  = optional(number)\n    deadlock_timeout           = optional(number)\n    effective_io_concurrency   = optional(number)\n    max_replication_slots      = optional(number)\n    max_wal_senders            = optional(number)\n    shared_buffers             = optional(number)\n    synchronous_commit         = optional(string)\n    wal_level                  = optional(string)\n    archive_timeout            = optional(number)\n    log_min_duration_statement = optional(number)\n  })",
      "description": "Database configuration",
      "source": [
        "ibm_database.postgresql_db.configuration"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 104
      }
    },
    "existing_kms_instance_guid": {
      "name": "existing_kms_instance_guid",
      "type": "string",
      "description": "The GUID of the Hyper Protect or Key Protect instance in which the key specified in var.kms_key_crn and var.backup_encryption_key_crn is coming from. Only required if var.kms_encryption_enabled is 'true', var.skip_iam_authorization_policy is 'false', and passing a value for var.kms_key_crn and/or var.backup_encryption_key_crn.",
      "source": [
        "ibm_iam_authorization_policy.kms_policy.target_resource_instance_id"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 199
      },
      "immutable": true,
      "computed": true
    },
    "kms_encryption_enabled": {
      "name": "kms_encryption_enabled",
      "type": "bool",
      "description": "Set this to true to control the encryption keys used to encrypt the data that you store in IBM Cloud® Databases. If set to false, the data is encrypted by using randomly generated keys. For more info on Key Protect integration, see https://cloud.ibm.com/docs/cloud-databases?topic=cloud-databases-key-protect. For more info on HPCS integration, see https://cloud.ibm.com/docs/cloud-databases?topic=cloud-databases-hpcs",
      "default": false,
      "source": [
        "ibm_iam_authorization_policy.kms_policy.count"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 163
      }
    },
    "kms_key_crn": {
      "name": "kms_key_crn",
      "type": "string",
      "description": "The root key CRN of a Key Management Services like Key Protect or Hyper Protect Crypto Service (HPCS) that you want to use for disk encryption. Only used if var.kms_encryption_enabled is set to true.",
      "source": [
        "ibm_database.postgresql_db.key_protect_key"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 169
      },
      "immutable": true
    },
    "member_cpu_count": {
      "name": "member_cpu_count",
      "type": "number",
      "description": "Allocated dedicated CPU per-member. For shared CPU, set to 0. See the following doc for supported values: https://cloud.ibm.com/docs/databases-for-postgresql?topic=databases-for-postgresql-resources-scaling",
      "default": 0,
      "pos": {
        "filename": "variables.tf",
        "line": 63
      }
    },
    "member_disk_mb": {
      "name": "member_disk_mb",
      "type": "number",
      "description": "Allocated disk per-member. See the following doc for supported values: https://cloud.ibm.com/docs/databases-for-postgresql?topic=databases-for-postgresql-resources-scaling",
      "default": 5120,
      "pos": {
        "filename": "variables.tf",
        "line": 56
      }
    },
    "member_memory_mb": {
      "name": "member_memory_mb",
      "type": "number",
      "description": "Allocated memory per-member. See the following doc for supported values: https://cloud.ibm.com/docs/databases-for-postgresql?topic=databases-for-postgresql-resources-scaling",
      "default": 1024,
      "pos": {
        "filename": "variables.tf",
        "line": 49
      }
    },
    "members": {
      "name": "members",
      "type": "number",
      "description": "Allocated number of members. Members can be scaled up but not down.",
      "default": 3,
      "pos": {
        "filename": "variables.tf",
        "line": 81
      }
    },
    "name": {
      "name": "name",
      "type": "string",
      "description": "The name to give the Postgresql instance.",
      "required": true,
      "source": [
        "ibm_database.postgresql_db.name"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 10
      }
    },
    "pg_version": {
      "name": "pg_version",
      "type": "string",
      "description": "Version of the PostgreSQL instance to provision.",
      "source": [
        "ibm_database.postgresql_db.version"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 27
      },
      "immutable": true,
      "computed": true
    },
    "pitr_id": {
      "name": "pitr_id",
      "type": "string",
      "description": "(Optional) The ID of the source deployment PostgreSQL instance that you want to recover back to. The PostgreSQL instance is expected to be in an up and in running state.",
      "source": [
        "ibm_database.postgresql_db.point_in_time_recovery_deployment_id"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 246
      }
    },
    "pitr_time": {
      "name": "pitr_time",
      "type": "string",
      "description": "(Optional) The timestamp in UTC format (%Y-%m-%dT%H:%M:%SZ) that you want to restore to. To retrieve the timestamp, run the command (ibmcloud cdb postgresql earliest-pitr-timestamp \u003cdeployment name or CRN\u003e). For more info on Point-in-time Recovery, see https://cloud.ibm.com/docs/databases-for-postgresql?topic=databases-for-postgresql-pitr",
      "source": [
        "ibm_database.postgresql_db.point_in_time_recovery_time"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 252
      }
    },
    "plan_validation": {
      "name": "plan_validation",
      "type": "bool",
      "description": "Enable or disable validating the database parameters for PostgreSQL during the plan phase.",
      "default": true,
      "source": [
        "ibm_database.postgresql_db.plan_validation"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 15
      }
    },
    "region": {
      "name": "region",
      "type": "string",
      "description": "The region where you want to deploy your instance.",
      "default": "us-south",
      "required": true,
      "source": [
        "ibm_database.postgresql_db.location"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 43
      },
      "cloud_data_type": "region"
    },
    "remote_leader_crn": {
      "name": "remote_leader_crn",
      "type": "string",
      "description": "A CRN of the leader database to make the replica(read-only) deployment. The leader database is created by a database deployment with the same service ID. A read-only replica is set up to replicate all of your data from the leader deployment to the replica deployment by using asynchronous replication. For more information, see https://cloud.ibm.com/docs/databases-for-postgresql?topic=databases-for-postgresql-read-only-replicas",
      "source": [
        "ibm_database.postgresql_db.remote_leader_id"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 21
      }
    },
    "resource_group_id": {
      "name": "resource_group_id",
      "type": "string",
      "description": "The resource group ID where the PostgreSQL instance will be created.",
      "required": true,
      "source": [
        "ibm_database.postgresql_db.resource_group_id",
        "ibm_iam_authorization_policy.kms_policy.source_resource_group_id"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 5
      },
      "cloud_data_type": "resource_group",
      "immutable": true,
      "computed": true,
      "cloud_data_range": [
        "resolved_to:id"
      ]
    },
    "resource_tags": {
      "name": "resource_tags",
      "type": "list(string)",
      "description": "Optional list of tags to be added to the PostgreSQL instance and the associated service credentials (if creating).",
      "default": [],
      "source": [
        "ibm_database.postgresql_db.tags",
        "ibm_resource_key.service_credentials.tags"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 98
      },
      "cloud_data_type": "tags",
      "min_length": 1,
      "max_length": 128,
      "matches": "^[A-Za-z0-9:_ .-]+$",
      "computed": true,
      "elem": {
        "type": "TypeString"
      }
    },
    "service_credential_names": {
      "name": "service_credential_names",
      "type": "map(string)",
      "description": "Map of name, role for service credentials that you want to create for the database",
      "default": {},
      "source": [
        "ibm_resource_key.service_credentials.for_each"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 70
      }
    },
    "service_endpoints": {
      "name": "service_endpoints",
      "type": "string",
      "description": "Specify whether you want to enable the public, private, or both service endpoints. Supported values are 'public', 'private', or 'public-and-private'.",
      "default": "private",
      "source": [
        "ibm_database.postgresql_db.service_endpoints"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 88
      },
      "options": "public, private, public-and-private"
    },
    "skip_iam_authorization_policy": {
      "name": "skip_iam_authorization_policy",
      "type": "bool",
      "description": "Set to true to skip the creation of an IAM authorization policy that permits all PostgreSQL database instances in the given resource group to read the encryption key from the Hyper Protect or Key Protect instance passed in var.existing_kms_instance_guid. If set to 'false', a value must be passed for var.existing_kms_instance_guid. No policy is created if var.kms_encryption_enabled is set to 'false'.",
      "default": false,
      "pos": {
        "filename": "variables.tf",
        "line": 193
      }
    }
  },
  "outputs": {
    "cbr_rule_ids": {
      "name": "cbr_rule_ids",
      "description": "CBR rule ids created to restrict Postgresql",
      "pos": {
        "filename": "outputs.tf",
        "line": 37
      }
    },
    "crn": {
      "name": "crn",
      "description": "Postgresql instance crn",
      "value": "ibm_database.postgresql_db.resource_crn",
      "pos": {
        "filename": "outputs.tf",
        "line": 20
      },
      "type": "TypeString"
    },
    "guid": {
      "name": "guid",
      "description": "Postgresql instance guid",
      "value": "ibm_database.postgresql_db.guid",
      "pos": {
        "filename": "outputs.tf",
        "line": 10
      },
      "type": "TypeString"
    },
    "id": {
      "name": "id",
      "description": "Postgresql instance id",
      "value": "ibm_database.postgresql_db.id",
      "pos": {
        "filename": "outputs.tf",
        "line": 5
      }
    },
    "service_credentials_json": {
      "name": "service_credentials_json",
      "description": "Service credentials json map",
      "value": "local.service_credentials_json",
      "sensitive": true,
      "pos": {
        "filename": "outputs.tf",
        "line": 25
      }
    },
    "service_credentials_object": {
      "name": "service_credentials_object",
      "description": "Service credentials object",
      "value": "local.service_credentials_object",
      "sensitive": true,
      "pos": {
        "filename": "outputs.tf",
        "line": 31
      }
    },
    "version": {
      "name": "version",
      "description": "Postgresql instance version",
      "value": "ibm_database.postgresql_db.version",
      "pos": {
        "filename": "outputs.tf",
        "line": 15
      },
      "type": "TypeString"
    }
  },
  "required_core": [
    "\u003e= 1.3.0"
  ],
  "required_providers": {
    "ibm": {
      "source": "IBM-Cloud/ibm",
      "version_constraints": [
        "\u003e= 1.49.0"
      ]
    }
  },
  "managed_resources": {
    "ibm_database.postgresql_db": {
      "mode": "managed",
      "type": "ibm_database",
      "name": "postgresql_db",
      "attributes": {
        "backup_id": "backup_crn",
        "configuration": "configuration",
        "key_protect_key": "kms_key_crn",
        "location": "region",
        "name": "name",
        "plan_validation": "plan_validation",
        "point_in_time_recovery_deployment_id": "pitr_id",
        "point_in_time_recovery_time": "pitr_time",
        "remote_leader_id": "remote_leader_crn",
        "resource_group_id": "resource_group_id",
        "service_endpoints": "service_endpoints",
        "tags": "resource_tags",
        "version": "pg_version"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 39
      }
    },
    "ibm_iam_authorization_policy.kms_policy": {
      "mode": "managed",
      "type": "ibm_iam_authorization_policy",
      "name": "kms_policy",
      "attributes": {
        "count": "kms_encryption_enabled",
        "source_resource_group_id": "resource_group_id",
        "target_resource_instance_id": "existing_kms_instance_guid"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 29
      }
    },
    "ibm_resource_key.service_credentials": {
      "mode": "managed",
      "type": "ibm_resource_key",
      "name": "service_credentials",
      "attributes": {
        "for_each": "service_credential_names",
        "tags": "resource_tags"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 168
      }
    }
  },
  "data_resources": {},
  "module_calls": {
    "cbr_rule": {
      "name": "cbr_rule",
      "source": "git::https://github.com/terraform-ibm-modules/terraform-ibm-cbr//cbr-rule-module?ref=v1.2.0",
      "attributes": {
        "count": "cbr_rules",
        "enforcement_mode": "cbr_rules",
        "resources": "cbr_rules",
        "rule_contexts": "cbr_rules",
        "rule_description": "cbr_rules"
      },
      "managed_resources": {
        "ibm_cbr_rule.cbr_rule": {
          "mode": "managed",
          "type": "ibm_cbr_rule",
          "name": "cbr_rule",
          "attributes": {
            "description": "rule_description",
            "enforcement_mode": "enforcement_mode"
          },
          "provider": {
            "name": "ibm"
          },
          "pos": {
            "filename": ".terraform/modules/cbr_rule/cbr-rule-module/main.tf",
            "line": 7
          }
        }
      },
      "data_resources": {},
      "outputs": {
        "rule_crn": {
          "name": "rule_crn",
          "description": "CBR rule resource instance crn",
          "value": "ibm_cbr_rule.cbr_rule.crn",
          "pos": {
            "filename": ".terraform/modules/cbr_rule/cbr-rule-module/outputs.tf",
            "line": 15
          },
          "type": "TypeString",
          "cloud_data_type": "crn"
        },
        "rule_description": {
          "name": "rule_description",
          "description": "CBR rule resource instance description",
          "value": "ibm_cbr_rule.cbr_rule.description",
          "pos": {
            "filename": ".terraform/modules/cbr_rule/cbr-rule-module/outputs.tf",
            "line": 5
          },
          "type": "TypeString"
        },
        "rule_href": {
          "name": "rule_href",
          "description": "CBR rule resource href",
          "value": "ibm_cbr_rule.cbr_rule.href",
          "pos": {
            "filename": ".terraform/modules/cbr_rule/cbr-rule-module/outputs.tf",
            "line": 20
          },
          "type": "TypeString"
        },
        "rule_id": {
          "name": "rule_id",
          "description": "CBR rule resource instance id",
          "value": "ibm_cbr_rule.cbr_rule.id",
          "pos": {
            "filename": ".terraform/modules/cbr_rule/cbr-rule-module/outputs.tf",
            "line": 10
          }
        }
      },
      "pos": {
        "filename": "main.tf",
        "line": 130
      }
    }
  }
}
